<!doctype html>
<html lang="it">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WebApp</title>

  <!-- Leaflet CSS/JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- deck.gl standalone + ponte Leaflet -->
  <script src="https://unpkg.com/deck.gl@9/dist.min.js"></script>
  <script src="https://unpkg.com/deck.gl-leaflet@1.3.1/dist/deck.gl-leaflet.min.js"></script>

  <script src="https://unpkg.com/georaster"></script>
  <script src="https://unpkg.com/georaster-layer-for-leaflet"></script>
  <script src="https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js"></script>

  <link rel="stylesheet" href="../static/css/index.css" />

  <!-- Markdown -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.1/marked.min.js"></script>
  <!-- Higlight code in html markdown -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-light.min.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css"> -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>


  <!-- Material Symbols Outlined -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />

  <!-- Colormaps -->
  <script src="https://cdn.jsdelivr.net/npm/chroma-js@2.4.2/chroma.min.js"></script>

  <!-- Dipendenze: geotiff v1.0.0-beta.13 e plotty -->
  <script src="https://unpkg.com/geotiff@1.0.0-beta.13/dist-browser/geotiff.min.js"></script>
  <script src="https://unpkg.com/plotty@0.4.9/dist/plotty.min.js"></script>

  <!-- Plugin + renderer plotty -->
  <script src="https://unpkg.com/leaflet-geotiff-2@1.1.0/dist/leaflet-geotiff.min.js"></script>
  <script src="https://unpkg.com/leaflet-geotiff-2@1.1.0/dist/leaflet-geotiff-plotty.min.js"></script>




  <!-- Bootstrap -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script> -->
</head>

<body data-server='{{ data|tojson }}'>


  {% include 'layers.html' %}

  {% include 'chat.html' %}


  <script>
    const body = document.querySelector('body');
    const serverData = body.dataset.server ? JSON.parse(body.dataset.server) : {};
    console.log("Server data:", serverData);

    // serverData.page_data.project.init_actions.map_actions.map(map_action => handleMapAction(map_action));


    console.log('LeafletGeotiff:', !!L.LeafletGeotiff, 'plotty:', !!L.LeafletGeotiff?.plotty);
  </script>

  <script src="../static/js/_utils.js"></script>
  <script src="../static/js/_map_utils.js"></script>
  <script src="../static/js/_chat_utils.js"></script>
</body>

</html>